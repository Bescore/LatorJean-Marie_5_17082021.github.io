if("127.0.0.1"===location.hostname){var Urlapi="http://localhost:3000";console.log(Urlapi)}else Urlapi="https://secret-cliffs-34868.herokuapp.com";function getArticleId(){return new URL(location.href).searchParams.get("article")}document.getElementById("mouv")&&fetch(`${Urlapi}/api/cameras`).then(e=>e.json().then(e=>{let t='<ul style="display:flex; flex-wrap:wrap; margin:auto; align-items : center;justify-content:center;">';for(let a of e)t+=`<li   class="card cardtransfo"  >\n                  <img class="card-img-top" src="${a.imageUrl}" alt="Appareil photo">\n                  <a href="produit.html?article=${a._id}"  class="stretched-link card-body">\n                    <p class="card-text text-dark">${"Modèle : "+a.name}</p>\n                  </a>\n                </li>`;t+="</ul>",document.getElementById("mouv").innerHTML=t}).catch(function(){console.log("ne peut fetch la page index car vous êtes sur la mauvaise page")}));const id=getArticleId();function isclicked(){if(localStorage.getItem(id)){let e=parseInt(localStorage.getItem(id));localStorage.setItem(id,++e),alert("vous en choisissez un de plus"),reloadPage()}else localStorage.setItem(id,1),alert("vous avez sélectionné ce produit"),reloadPage()}function deleletItem(){localStorage.removeItem(id,id),alert("vous avez enlevé ce produit du panier"),reloadPage()}function deleteLastitem(){localStorage.removeItem(localStorage.key(localStorage.length-1)),0===localStorage.length&&sessionStorage.removeItem("prix")}function deleteAllitem(){localStorage.clear(),sessionStorage.removeItem("Idorder"),sessionStorage.removeItem("prix")}function reloadPage(){document.location.reload()}function allStorage(){var e="",t=0;for(let a=0;a<localStorage.length;a++)fetch(`${Urlapi}/api/cameras/${Object.keys(localStorage)[a]}`).then(a=>a.json().then(a=>{document.getElementById("mouv3")&&(e+=`<div   class="card cardmouv cardpic">\n            <img class="card-img-top" src="${a.imageUrl}" alt="Appareil photo">\n            <a href="produit.html?article=${a._id}" style="text-decoration:none" class=" stretched-link card-body">\n              <p class="card-text my-1 text-dark">${"Modèle : "+a.name}</p>\n              <p  class="card-text text-dark "><span>Prix :</span>${" "+a.price/100+" €"}</p>\n              <p class="quantity" >(${localStorage.getItem(a._id)})</p>\n            </a>\n          </div>`,document.getElementById("mouv3").innerHTML=e,t+=localStorage.getItem(a._id)*a.price/100,Price.push(t),console.log(Price),document.getElementById("total").innerHTML="Coût total : "+t+"€",sessionStorage.setItem("prix",t))}))}document.getElementById("mouv2")&&fetch(`${Urlapi}/api/cameras/${id}`).then(e=>e.json().then(e=>{let t,a=`<div class="card cart-card" >\n        <img class="card-img-top" src="${e.imageUrl}" alt="Appareil photo">\n        <div style="display:flex;justify-content-center;flex-direction:column" class="card-body">\n          <p  class="card-text"><span>Modèle :</span>${"  "+e.name}</p>\n          <p  class="card-text"><span>Prix :</span>${" "+e.price/100+" €"}</p>\n          <label class="forlenses card-text"  for="lense-select">Lentilles</label>\n          <select  class="form-group" id="lense-select"></select>\n          <button id=${e.id}  type="button" onClick="isclicked(id)"   class="btn btn-primary btn-sm touch ">Selectionner</button>\n          <button id=${e._id}  type="submit" onclick="deleletItem(id)" class="btn btn-primary btn-sm touch ">Supprimer du panier</button>\n        </div>\n      </div>`,n=`<div class="value text-center text-warning fs-4">Quantité: ${localStorage.getItem(id)}</div>`;for(let a of e.lenses)t+=`<option value="${a}">${a}</option>`;document.getElementById("mouv2").innerHTML=a,document.getElementById("lense-select").innerHTML=t,null==localStorage.getItem(id)?document.getElementById("quantity").innerHTML='<div class="value text-center text-warning fs-4" >Ce produit n\'est pas dans votre panier</div>':document.getElementById("quantity").innerHTML=n}));var Price=[];function isValidated(e,t){if(/^[a-zA-z\s]+$/.test(e)){let e='<p class=" alert alert-success fs-6">Valide !</p>';document.getElementById(t).innerHTML=e}else{let e='<p id="nonvalide" class="alert alert-danger fs-6">Non valide !</p>';document.getElementById(t).innerHTML=e}}function validAdress(e,t){if(/[0-9\\\/# ,a-zA-Z]+[ ,]+[0-9\\\/#, a-zA-Z]{1,}/.test(e)){let e='<p class="alert alert-success fs-6">Valide !</p>';document.getElementById(t).innerHTML=e}else{let e='<p id="nonvalide" class="alert alert-danger fs-6">Non valide !</p>';document.getElementById(t).innerHTML=e,document.getElementById("adress").value=""}}function validMail(e,t){if(/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(e)){let e='<p class=" alert alert-success fs-6">Valide !</i></p>';document.getElementById(t).innerHTML=e}else{let e='<p id="nonvalide" class="alert alert-danger fs-6">Non valide !</p>';document.getElementById(t).innerHTML=e,document.getElementById("email").value=""}}const Prenom=document.getElementById("firstName");if(document.getElementById("mouv3")){function getName(){isValidated(Prenom.value,"validate"),contact.firstName=`${Prenom.value}`}Prenom.addEventListener("change",getName)}const Nom=document.getElementById("lastName");if(document.getElementById("mouv3")){function getlastName(){isValidated(Nom.value,"validate1"),contact.lastName=`${Nom.value}`}Nom.addEventListener("change",getlastName)}const Adress=document.getElementById("adress");if(document.getElementById("mouv3")){function getadress(){validAdress(Adress.value,"validate2"),contact.address=`${Adress.value}`}Adress.addEventListener("change",getadress)}const City=document.getElementById("city");if(document.getElementById("mouv3")){function getcity(){isValidated(City.value,"validate3"),contact.city=`${City.value}`}City.addEventListener("change",getcity)}const Email=document.getElementById("email");if(document.getElementById("mouv3")){function getemail(){validMail(Email.value,"validate4"),console.log(Email.value),contact.email=`${Email.value}`}Email.addEventListener("change",getemail)}var contact={firstName:"",lastName:"",address:"",city:"",email:""};const isEmpty=Object.values(contact).every(e=>null===e||""===e);var products=Object.keys(localStorage);function Forms(){event.preventDefault(),fetch(`${Urlapi}/api/cameras/order`,{method:"POST",body:JSON.stringify({contact:contact,products:products}),headers:{"Content-Type":"application/json"}}).then(e=>e.json().then(e=>{console.log(e),sessionStorage.setItem("Idorder",`${e.orderId}`),document.getElementById("nonvalide")?alert("Le formulaire est invalide"):e.orderId&&sessionStorage.getItem("prix")&&!1!==isEmpty?window.location.href="commande.html":alert("Veuillez selectionner un produit et/ou remplir le formulaire")}).catch(function(){console.log("problème au niveau du fetch d'envoie de commande")}))}var Iddecommande=sessionStorage.getItem("Idorder");function Displayorder(){Iddecommande&&document.getElementById("mouv4")&&(document.getElementById("mouv4").innerHTML="Commande: "+Iddecommande)}Displayorder();var Prixdecommande=sessionStorage.getItem("prix");function Displayprice(){Prixdecommande&&document.getElementById("mouv4")&&(document.getElementById("totalC").innerText="Merci de nous avoir choisi ! le coût total de votre commande est de : "+Prixdecommande+" €")}Displayprice();